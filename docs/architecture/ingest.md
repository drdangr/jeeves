# Ingest: модуль загрузки и подготовки знаний

## Назначение

Модуль `Ingest` отвечает за загрузку, обработку и структурирование исходного контента (в основном — Markdown-документов), чтобы превратить его в пригодную для поиска и анализа базу знаний. Он является входной точкой всей системы RAG и формирует основу для работы Искателя и Аналитика.

---

## Задачи модуля

- Загрузка файлов из указанной директории (например, `content/`)
    
- Чанкирование (разбиение текста на смысловые блоки)
    
- Извлечение тегов и метаинформации
    
- Генерация эмбеддингов для каждого чанка
    
- Индексация чанков в векторной базе (например, Chroma, FAISS)
    
- Обновление индексов при изменении исходных файлов
    

---

## Этапы обработки

### 1. Загрузка и обход файловой структуры

- Поддержка Markdown (.md), возможно — .txt и .docx
    
- Рекурсивный обход поддиректорий
    
- Сопоставление файлов с логикой структуры мира (темы, персонажи, главы)
    

### 2. Чанкирование

- Алгоритм: по заголовкам, абзацам или пользовательским маркерам
    
- Гибкая настройка размера чанков (по токенам или символам)
    
- Связывание чанков с оригинальным файлом и его структурной позицией
    

### 3. Извлечение тегов и метаданных

- Распознавание тегов `#тег` внутри Markdown
    
- Извлечение ссылок `[[...]]` и заголовков как признаков связности
    
- Привязка к дате или временным меткам (для временной шкалы)
    

### 4. Генерация эмбеддингов

- Используемая модель: `ai-forever/sbert_large_mt_nlu_ru`
    
- Библиотека: `sentence-transformers`
    
- Возможность локальной генерации на GPU
    

### 5. Индексация и хранение

- Сохраняемые данные: текст чанка, эмбеддинг, источник, теги, ссылки
    
- Векторное хранилище: FAISS, ChromaDB, AnnLite (опционально)
    
- Хэш или UUID каждого чанка для отслеживания изменений
    

---

## Интерфейс взаимодействия

- `ingest(path: str) -> List[Chunk]` — запускает полный процесс обработки
    
- `update_if_changed(path: str)` — обновление только при изменениях
    

---

## Используется в:

- [[docs/architecture/seeker|Seeker]] — для поиска по базе знаний
    
- [[docs/architecture/analyst|Analyst]] — для получения полнотекстового контекста
    
- [[docs/architecture/interface|Interface]] — для отображения актуального документа и его связей